from openpyxl import Workbook
from registration.models import *
from django.contrib.auth.models import User

def getGenParticipant():
    all_gps = GenParticipant.objects.all()

    wb = Workbook()
    ws = wb.active
    ws.title = "genparticipant"

    ws["A1"] = "Name"
    ws["B1"] = "City"
    ws["C1"] = "Phone"
    ws["D1"] = "Gender"
    ws["E1"] = "Email"

    row = 2
    for gp in all_gps:
        ws["A{}".format(row)] = gp.name
        ws["B{}".format(row)] = gp.city
        ws["C{}".format(row)] = gp.phone
        ws["D{}".format(row)] = gp.gender
        ws["E{}".format(row)] = gp.email_address
        row += 1

    wb.save("./scripts/DataSheets/GenParticipant.xlsx")
    print("GenParticipant.xlsx generated.")
